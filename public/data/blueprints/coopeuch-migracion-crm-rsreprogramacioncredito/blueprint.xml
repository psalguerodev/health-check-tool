<?xml version="1.0" encoding="UTF-8"?>
<blueprint xmlns="http://www.osgi.org/xmlns/blueprint/v1.0.0"
    xmlns:cm="http://aries.apache.org/blueprint/xmlns/blueprint-cm/v1.0.0"
    xmlns:cxf="http://camel.apache.org/schema/blueprint/cxf"
    xmlns:ext="http://aries.apache.org/blueprint/xmlns/blueprint-ext/v1.0.0"
    xmlns:soap="http://cxf.apache.org/blueprint/bindings/soap"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://www.osgi.org/xmlns/blueprint/v1.0.0 https://www.osgi.org/xmlns/blueprint/v1.0.0/blueprint.xsd                            http://camel.apache.org/schema/blueprint http://camel.apache.org/schema/blueprint/camel-blueprint.xsd">
    <cm:property-placeholder persistent-id="wsreprogramacion"/>
    <bean class="cl.coopeuch.crm.wsreprogramacion.util.RouteFacade" id="beanRouteFacade"/>
    <cxf:cxfEndpoint address="/crm/WSReprogramacion"
        id="fromReprogramacionEndPoint"
        serviceClass="cl.coopeuch.crm.wsreprogramacion.WSReprogramacionSoap" wsdlURL="wsdl/WSReprogramacion.wsdl"/>
    <cxf:cxfEndpoint address="{{http-proxy.wsreprogramacion.url.to}}"
        id="toReprogramacionEndPoint"
        serviceClass="cl.coopeuch.crm.wsreprogramacion.WSReprogramacionSoap" wsdlURL="{{http-proxy.wsreprogramacion.url.to}}?wsdl"/>
    <cxf:rsServer address="/crm/RSReprogramacion"
        id="fromRSReprogramacionEndPoint" loggingFeatureEnabled="true" serviceClass="cl.coopeuch.crm.wsreprogramacion.rest.ReprogramacionRest"/>
    <camelContext id="servicio-reprogramacion-context" xmlns="http://camel.apache.org/schema/blueprint">
        <route id="reprogramacion" streamCache="true">
            <from id="reprogramacionFrom" uri="cxf:bean:fromReprogramacionEndPoint?dataFormat=MESSAGE"/>
            <removeHeaders id="removeHeadersReprogramacion" pattern="CamelHttp*"/>
            <to id="reprogramacionTo" uri="cxf:bean:toReprogramacionEndPoint?dataFormat=MESSAGE"/>
        </route>
        <route id="inicio-rest">
            <from id="restInicio" uri="cxfrs:bean:fromRSReprogramacionEndPoint"/>
            <choice id="fromOperation">
                <when id="whencrearSolicitudReprogramacionFogape">
                    <simple>${header.operationName} == 'crearSolicitudReprogramacionFogape'</simple>
                    <unmarshal id="unmarshalcrearSolicitudReprogramacionFogape">
                        <json include="NON_NULL" library="Jackson" unmarshalTypeName="cl.coopeuch.crm.wsreprogramacion.CrearSolicitudReprogramacionFogape"/>
                    </unmarshal>
                    <bean id="crearSolicitudReprogramacionFogapeRequest"
                        method="crearSolicitudReprogramacionFogapeRest" ref="beanRouteFacade"/>
                    <to id="crearSolicitudReprogramacionFogapeTo" uri="cxf:bean:toReprogramacionEndPoint?loggingFeatureEnabled=true"/>
                    <bean
                        id="ccrearSolicitudReprogramacionFogapeResponse"
                        method="crearSolicitudReprogramacionFogapeResponse" ref="beanRouteFacade"/>
                    <marshal id="marshalcrearSolicitudReprogramacionFogapeResponse">
                        <json include="NON_NULL" library="Jackson" unmarshalTypeName="cl.coopeuch.crm.wsreprogramacion.Response"/>
                    </marshal>
                </when>
                <when id="whenconsultarBaseRiesgoFogape">
                    <simple>${header.operationName} == 'consultarBaseRiesgoFogape'</simple>
                    <unmarshal id="unmarshalconsultarBaseRiesgoFogape">
                        <json include="NON_NULL" library="Jackson" unmarshalTypeName="cl.coopeuch.crm.wsreprogramacion.ConsultarBaseRiesgoFogape"/>
                    </unmarshal>
                    <bean id="consultarBaseRiesgoFogapeRequest"
                        method="consultarBaseRiesgoFogapeRest" ref="beanRouteFacade"/>
                    <to id="consultarBaseRiesgoFogapeTo" uri="cxf:bean:toReprogramacionEndPoint?loggingFeatureEnabled=true"/>
                    <bean
                        id="consultarBaseRiesgoFogapeResponse"
                        method="consultarBaseRiesgoFogapeResponse" ref="beanRouteFacade"/>
                    <marshal id="marshalconsultarBaseRiesgoFogapeResponse">
                        <json include="NON_NULL" library="Jackson" unmarshalTypeName="cl.coopeuch.crm.wsreprogramacion.ResponseBaseRiesgo"/>
                    </marshal>
                </when>
                <when id="whencrearFormalizacionReprogramacionFogape">
                    <simple>${header.operationName} == 'crearFormalizacionReprogramacionFogape'</simple>
                    <unmarshal id="unmarshalcrearFormalizacionReprogramacionFogape">
                        <json include="NON_NULL" library="Jackson" unmarshalTypeName="cl.coopeuch.crm.wsreprogramacion.CrearFormalizacionReprogramacionFogape"/>
                    </unmarshal>
                    <bean
                        id="crearFormalizacionReprogramacionFogapeRequest"
                        method="crearFormalizacionReprogramacionFogapeRest" ref="beanRouteFacade"/>
                    <to id="crearFormalizacionReprogramacionFogapeTo" uri="cxf:bean:toReprogramacionEndPoint?loggingFeatureEnabled=true"/>
                    <bean
                        id="crearFormalizacionReprogramacionFogapeResponse"
                        method="crearFormalizacionReprogramacionFogapeResponse" ref="beanRouteFacade"/>
                    <marshal id="marshalcrearFormalizacionReprogramacionFogapeResponse">
                        <json include="NON_NULL" library="Jackson" unmarshalTypeName="cl.coopeuch.crm.wsreprogramacion.Response"/>
                    </marshal>
                </when>
                <when id="whenconsultarDocumentacionFormalizacionFogape">
                    <simple>${header.operationName} == 'consultarDocumentacionFormalizacionFogape'</simple>
                    <unmarshal id="unmarshalconsultarDocumentacionFormalizacionFogape">
                        <json include="NON_NULL" library="Jackson" unmarshalTypeName="cl.coopeuch.crm.wsreprogramacion.ConsultarDocumentacionFormalizacionFogape"/>
                    </unmarshal>
                    <bean
                        id="consultarDocumentacionFormalizacionFogapeRequest"
                        method="consultarDocumentacionFormalizacionFogapeRest" ref="beanRouteFacade"/>
                    <to id="consultarDocumentacionFormalizacionFogapeTo" uri="cxf:bean:toReprogramacionEndPoint?loggingFeatureEnabled=true"/>
                    <bean
                        id="consultarDocumentacionFormalizacionFogapeResponse"
                        method="consultarDocumentacionFormalizacionFogapeResponse" ref="beanRouteFacade"/>
                    <marshal id="marshalconsultarDocumentacionFormalizacionFogapeResponse">
                        <json include="NON_NULL" library="Jackson" unmarshalTypeName="cl.coopeuch.crm.wsreprogramacion.ResponseDocumentacionFormalizacionFogape"/>
                    </marshal>
                </when>
            </choice>
        </route>
    </camelContext>
</blueprint>
